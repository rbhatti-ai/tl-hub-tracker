<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T&L Hub Portfolio Tracker</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; color: #333; }
        .header { background: linear-gradient(135deg, #1e3a5f 0%, #2d5a87 100%); color: white; padding: 20px 30px; }
        .header h1 { font-size: 24px; margin-bottom: 5px; }
        .header p { opacity: 0.8; font-size: 14px; }
        .stats-bar { display: flex; gap: 15px; padding: 20px 30px; background: white; border-bottom: 1px solid #e0e0e0; flex-wrap: wrap; }
        .stat-card { background: #f8f9fa; border-radius: 8px; padding: 15px 20px; min-width: 140px; }
        .stat-card .number { font-size: 28px; font-weight: bold; color: #1e3a5f; }
        .stat-card .label { font-size: 12px; color: #666; text-transform: uppercase; }
        .stat-card.completed .number { color: #28a745; }
        .stat-card.in-progress .number { color: #fd7e14; }
        .stat-card.not-started .number { color: #6c757d; }
        .stat-card.overdue .number { color: #dc3545; }
        .controls { padding: 20px 30px; display: flex; gap: 15px; flex-wrap: wrap; align-items: center; }
        .controls select, .controls input { padding: 10px 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; }
        .refresh-btn { background: #1e3a5f; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; }
        .refresh-btn:hover { background: #2d5a87; }
        .container { padding: 0 30px 30px; }
        .table-wrapper { background: white; border-radius: 10px; overflow-x: auto; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; min-width: 1000px; }
        th { background: #1e3a5f; color: white; padding: 14px 12px; text-align: left; font-size: 13px; }
        td { padding: 12px; border-bottom: 1px solid #eee; font-size: 13px; }
        tr:hover { background: #f8f9fa; }
        .status-badge { padding: 5px 12px; border-radius: 20px; font-size: 11px; font-weight: 600; }
        .status-completed { background: #d4edda; color: #155724; }
        .status-in-progress { background: #fff3cd; color: #856404; }
        .status-not-started { background: #e2e3e5; color: #383d41; }
        .progress-bar { width: 80px; height: 8px; background: #e9ecef; border-radius: 4px; }
        .progress-fill { height: 100%; background: #28a745; border-radius: 4px; }
        .loading { text-align: center; padding: 60px; color: #666; }
        .last-updated { text-align: right; padding: 15px 30px; font-size: 12px; color: #666; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìä T&L Hub Portfolio Tracker</h1>
        <p>Transportation & Logistics Hub ‚Äì Initiatives Dashboard</p>
    </div>
    
    <div class="stats-bar">
        <div class="stat-card"><div class="number" id="totalCount">-</div><div class="label">Total</div></div>
        <div class="stat-card completed"><div class="number" id="completedCount">-</div><div class="label">Completed</div></div>
        <div class="stat-card in-progress"><div class="number" id="inProgressCount">-</div><div class="label">In Progress</div></div>
        <div class="stat-card not-started"><div class="number" id="notStartedCount">-</div><div class="label">Not Started</div></div>
        <div class="stat-card overdue"><div class="number" id="overdueCount">-</div><div class="label">Overdue</div></div>
    </div>
    
    <div class="controls">
        <select id="filterStatus" onchange="applyFilters()">
            <option value="">All Statuses</option>
            <option value="not started">Not Started</option>
            <option value="in progress">In Progress</option>
            <option value="completed">Completed</option>
        </select>
        <input type="text" id="searchInput" placeholder="Search initiatives..." oninput="applyFilters()">
        <button class="refresh-btn" onclick="loadData()">üîÑ Refresh</button>
    </div>
    
    <div class="container">
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Initiative</th>
                        <th>Type</th>
                        <th>Owner</th>
                        <th>Status</th>
                        <th>Progress</th>
                        <th>End Date</th>
                        <th>Primary KPI</th>
                        <th>Cost</th>
                        <th>Budget Source</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr><td colspan="10" class="loading">Loading...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="last-updated">Last refreshed: <span id="lastRefresh">-</span></div>

    <script>
        // ‚ö†Ô∏è REPLACE THIS URL WITH YOUR APPS SCRIPT WEB APP URL
        const API_URL = https://script.google.com/macros/s/AKfycbxVVVNhZti5Q6p_mZH6UfYMUJYHHHMkxe4Bppkvqwt25hR2znA2jcLeByxzAthKn6oz/exec
;
        
        let allData = [];
        
        async function loadData() {
            try {
                const response = await fetch(API_URL);
                allData = await response.json();
                updateStats();
                renderTable(allData);
                document.getElementById('lastRefresh').textContent = new Date().toLocaleString();
            } catch (error) {
                document.getElementById('tableBody').innerHTML = '<tr><td colspan="10" class="loading">Error loading data</td></tr>';
            }
        }
        
        function updateStats() {
            const today = new Date();
            let total = 0, completed = 0, inProgress = 0, notStarted = 0, overdue = 0;
            allData.forEach(item => {
                if (!item.ID) return;
                total++;
                const status = (item.Status || '').toLowerCase();
                if (status === 'completed') completed++;
                else if (status === 'in progress') inProgress++;
                else if (status === 'not started') notStarted++;
                if (item['End Date'] && status !== 'completed' && new Date(item['End Date']) < today) overdue++;
            });
            document.getElementById('totalCount').textContent = total;
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('inProgressCount').textContent = inProgress;
            document.getElementById('notStartedCount').textContent = notStarted;
            document.getElementById('overdueCount').textContent = overdue;
        }
        
        function renderTable(data) {
            const tbody = document.getElementById('tableBody');
            if (!data.length) { tbody.innerHTML = '<tr><td colspan="10" class="loading">No data</td></tr>'; return; }
            tbody.innerHTML = data.map(item => {
                const progress = Math.round((parseFloat(item['% Complete']) || 0) * 100);
                const statusClass = (item.Status || '').toLowerCase().replace(' ', '-');
                return `<tr>
                    <td>${item.ID || ''}</td>
                    <td><strong>${item.Initiative || ''}</strong></td>
                    <td>${item.Type || ''}</td>
                    <td>${item.Owner || ''}</td>
                    <td><span class="status-badge status-${statusClass}">${item.Status || ''}</span></td>
                    <td><div class="progress-bar"><div class="progress-fill" style="width:${progress}%"></div></div> ${progress}%</td>
                    <td>${item['End Date'] ? new Date(item['End Date']).toLocaleDateString() : ''}</td>
                    <td>${item['Primary KPI'] || ''}</td>
                    <td>${item['Estimated Cost'] ? '$' + item['Estimated Cost'].toLocaleString() : ''}</td>
                    <td>${item['Budget Source'] || ''}</td>
                </tr>`;
            }).join('');
        }
        
        function applyFilters() {
            const status = document.getElementById('filterStatus').value;
            const search = document.getElementById('searchInput').value.toLowerCase();
            const filtered = allData.filter(item => {
                const matchStatus = !status || (item.Status || '').toLowerCase() === status;
                const matchSearch = !search || (item.Initiative || '').toLowerCase().includes(search);
                return matchStatus && matchSearch;
            });
            renderTable(filtered);
        }
        
        loadData();
    </script>
</body>
</html>
